theme:
  background-color: 240 27 11
  contrast-multiplier: 1.5
  primary-color: 321 100 71
  positive-color: 165 78 51
  negative-color: 360 100 71
pages:
    - name: Home
      # Optionally, if you only have a single page you can hide the desktop navigation for a cleaner look
      # hide-desktop-navigation: true
      columns:
        - size: small
          widgets:
            - type: calendar
              first-day-of-week: monday
            - type: rss
              limit: 10
              collapse-after: 3
              cache: 12h
              feeds:
                - url: https://archlinux.org/feeds/news/
                  title: Arch Linux News
                  limit: 4
                - url: http://sreweekly.com/feed/
                  title: SRE Weekly
                  limit: 4
        - size: full
          widgets:
            - type: monitor
              title: Services
              sites:
                - title: Authentik
                  url: https://auth.${SECRET_EXTERNAL_DOMAIN}
                  check-url: http://authentik-server.authentik.svc.cluster.local:80
                  icon: di:authentik
                - title: Pihole
                  url: http://10.0.10.200/admin/
                  check-url: http://pihole-web.pihole-system.svc.cluster.local:80/admin/
                  icon: di:pi-hole
                - title: Glance
                  url: https://home.${SECRET_EXTERNAL_DOMAIN}
                  check-url: http://glance.glance.svc.cluster.local:8080
                  icon: di:glance
                - title: Linkwarden
                  url: https://bookmark.${SECRET_EXTERNAL_DOMAIN}
                  check-url: http://linkwarden.linkwarden.svc.cluster.local:80
                  icon: auto-invert https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/png/linkwarden.png
                - title: Uptime Kuma
                  url: https://status.${SECRET_EXTERNAL_DOMAIN}
                  check-url: http://uptime-kuma.uptime-kuma.svc.cluster.local:3001
                  icon: di:uptime-kuma
                - title: Grafana
                  url: https://metrics.${SECRET_EXTERNAL_DOMAIN}
                  check-url: http://grafana.observability.svc.cluster.local:80
                  icon: di:grafana
                - title: Mealie
                  url: https://recept.${SECRET_EXTERNAL_DOMAIN}
                  check-url: http://mealie.mealie.svc.cluster.local:80
                  icon: di:mealie
            - type: videos
              channels:
                # Mental Outlaw
                - UC7YOGHUfC1Tb6E4pudI9STA
                # SomeOrdinaryGamers
                - UCtMVHI3AJD4Qk4hcbZnI9ZQ
                # Fireship
                - UCsBjURrPoezykLs9EqgamOA
                # Low Level
                - UC6biysICWOJ-C3P4Tyeggzg
                # ThePrimeTime
                - UCUyeluBRhGPCW4rPe_UvBZQ
                # Linus Tech Tips
                - UCXuqSBlHAE6Xw-yeJA0Tunw
                # Veritasium
                - UCHnyfMqiRRG1u-2MsSQLbXA
            - type: group
              widgets:
                - type: reddit
                  subreddit: devops
                  show-thumbnails: true
                - type: reddit
                  subreddit: technology
                  show-thumbnails: true
                - type: reddit
                  subreddit: selfhosted
                  show-thumbnails: true
                - type: hacker-news
        - size: small
          widgets:
            - type: weather
              location: ${WEATHER_LOCATION}
              # alternatively "imperial"
              units: metric
              # alternatively "24h"
              hour-format: 12h
              # Optionally hide the location from being displayed in the widget
              # hide-location: true
            - type: dns-stats
              service: pihole-v6
              url: http://10.0.10.200
              username: admin
              password: ${PIHOLE_API_KEY}
            - type: markets
              # The link to go to when clicking on the symbol in the UI,
              # {SYMBOL} will be substituded with the symbol for each market
              markets:
                - symbol: VUAA.DE
                  name: Vanguard S&P 500 UCITS ETF
                  chart-link: https://www.tradingview.com/chart/?symbol=VUAA
                - symbol: VWCG.DE
                  name: Vanguard FTSE Developed Europe
                  chart-link: https://www.tradingview.com/chart/?symbol=VWCG
            - type: repository
              repository: ublue-os/bluefin
              pull-requests-limit: 5
              issues-limit: 3
              commits-limit: 3
            - type: repository
              repository: dnikoloski/infrastructure-as-code
              pull-requests-limit: 5
              issues-limit: 3
              commits-limit: 3
            - type: releases
              cache: 1d
              # Without authentication the Github API allows for up to 60 requests per hour. You can create a
              # read-only token from your Github account settings and use it here to increase the limit.
              # token: ...
              repositories:
                - ublue-os/bluefin
                - glanceapp/glance
                - siderolabs/talos
    - name: Homelab
      # Optionally, if you only have a single page you can hide the desktop navigation for a cleaner look
      # hide-desktop-navigation: true
      columns:
        - size: small
          widgets:
            - type: custom-api
              title: Uptime Kumas
              title-url: ${UPTIME_KUMA_URL}
              url: ${UPTIME_KUMA_URL}/api/status-page/${UPTIME_KUMA_STATUS_SLUG}
              subrequests:
                heartbeats:
                  url: ${UPTIME_KUMA_URL}/api/status-page/heartbeat/${UPTIME_KUMA_STATUS_SLUG}
              cache: 10m
              template: |
                {{ $hb := .Subrequest "heartbeats" }}

                {{ if not (.JSON.Exists "publicGroupList") }}
                <p class="color-negative">Error reading response</p>
                {{ else if eq (len (.JSON.Array "publicGroupList")) 0 }}
                <p>No monitors found</p>
                {{ else }}

                <ul class="dynamic-columns list-gap-8">
                  {{ range .JSON.Array "publicGroupList" }}
                  {{ range .Array "monitorList" }}
                  {{ $id := .String "id" }}
                  {{ $hbArray := $hb.JSON.Array (print "heartbeatList." $id) }}
                  <div class="flex items-center gap-12">
                    <a class="size-title-dynamic color-highlight text-truncate block grow" href="${UPTIME_KUMA_URL}/dashboard/{{ $id }}"
                      target="_blank" rel="noreferrer">
                      {{ .String "name" }} </a>

                    {{ if gt (len $hbArray) 0 }}
                      {{ $latest := index $hbArray (sub (len $hbArray) 1) }}
                      {{ if eq ($latest.Int "status") 1 }}
                      <div>{{ $latest.Int "ping" }}ms</div>
                      <div class="monitor-site-status-icon-compact" title="OK">
                        <svg fill="var(--color-positive)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                          <path fill-rule="evenodd"
                            d="M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.857-9.809a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 1 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z"
                            clip-rule="evenodd"></path>
                        </svg>
                      </div>
                      {{ else }}
                      <div><span class="color-negative">DOWN</span></div>
                      <div class="monitor-site-status-icon-compact" title="{{ if $latest.Exists "msg" }}{{ $latest.String "msg" }}{{ else
                        }}Error{{ end }}">
                        <svg fill="var(--color-negative)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                          <path fill-rule="evenodd"
                            d="M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495ZM10 5a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 10 5Zm0 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"
                            clip-rule="evenodd"></path>
                        </svg>
                      </div>
                      {{ end }}
                    {{ else }}
                      <div><span class="color-negative">No data</span></div>
                      <div class="monitor-site-status-icon-compact" title="No data available">
                        <svg fill="var(--color-negative)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                          <path d="M10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16zm0-2a6 6 0 1 0 0-12 6 6 0 0 0 0 12zm-.75-8a.75.75 0 0 1 1.5 0v3a.75.75 0 0 1-1.5 0V8zm.75 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                        </svg>
                      </div>
                    {{ end }}
                  </div>
                  {{ end }}
                  {{ end }}
                </ul>
                {{ end }}
        - size: small
          widgets:
            - type: custom-api
              cache: 30m
              headers:
                Authorization: Bearer ${LINKWARDEN_API_KEY}
              method: GET                                                                                     
              template: |
                <ul class="list list-gap-10 collapsible-container" data-collapse-after="<LINKS_TO_BE_VISIBLE>">
                  {{ range .JSON.Array "response" }}
                    <li>
                      {{ $title := .String "name" }}
                      {{ if gt (len $title) 50 }}
                        {{ $title = (slice $title 0 50) | printf "%s..." }}
                      {{ end }}
                      <a class="size-title-dynamic color-primary-if-not-visited"
                        href="{{ .String "url" }}"
                        target="_self"
                        rel="noopener noreferrer">
                        {{ $title }}
                      </a>
                      <ul class="list-horizontal-text">
                        <li style="color: {{ .String "collection.color" }};">
                          {{ .String "collection.name" }}
                        </li>
                        {{ $tags := .Array "tags" }}
                        {{ range $index, $tag := $tags }}
                          <li>{{ .String "name" }}</li>
                        {{ end }}
                      </ul>
                    </li>
                  {{ end }}
                </ul>
              title: Bookmarks
              url: http://linkwarden.linkwarden.svc.cluster.local:80/api/v1/links
        - size: small
          widgets:
            - type: custom-api
              title: Beszel Metrics
              url: http://beszel-hub.beszel.svc.cluster.local:8090/api/collections/systems/records
              method: GET
              options:
                redirect-url: "" # You must use "" and http:// or https://
              headers:
                Authorization: Bearer ${BESZEL_TOKEN}
                Accept: application/json
              template: |
                {{ $redirect := .Options.StringOr "redirect-url" "" }}
                {{ $newTab := .Options.BoolOr "in-new-tab" false }}
                {{ $hideKernel := .Options.BoolOr "hide-kernel" false }}
                {{ $hideUptime := .Options.BoolOr "hide-uptime" false }}
                {{ $hideCPUInfo := .Options.BoolOr "hide-cpu-info" false }}
                {{ $hideIP := .Options.BoolOr "hide-ip" false }}
                {{ $collapsible := .Options.BoolOr "collapsible" false }}
                {{ $items := .JSON.Array "items" }}
                {{ range $items }}
                  {{ $info := .Get "info" }}
                  {{ $name := .String "name" }}
                  {{ $link := "" }}
                  {{ if ne $redirect "" }}
                    {{ $link = printf "%s/system/%s" $redirect $name }}
                  {{ end }}
                  <div style="font-size: 1.15em;">
                    {{ if eq (.String "status") "up" }}
                      <span class="status-dot color-positive">‚óè</span>
                    {{ else }}
                      <span class="status-dot color-negative">‚óè</span>
                    {{ end }}
                    {{ if ne $redirect "" }}
                      <a class="color-highlight text-truncate" href="{{ printf "%s/system/%s" $redirect $name | safeURL }}" {{ if $newTab }}target="_blank" rel="noopener"{{ end }}>
                        {{ $name }}{{ if not $hideIP }} ({{ .String "host" }}){{ end }}
                      </a>
                    {{ else }}
                      <span class="color-highlight text-truncate">
                        {{ $name }}{{ if not $hideIP }} ({{ .String "host" }}){{ end }}
                      </span>
                    {{ end }}
                  </div>
                  {{ if $collapsible }}
                    <details class="margin-top-5">
                      <summary class="size-h5 color-subtle" style="cursor: pointer;">Metrics</summary>
                      <div class="margin-top-5">
                        {{ if not $hideKernel }}
                          <p style="font-size: 1em;">Kernel: {{ $info.String "k" }}</p>
                        {{ end }}
                        {{ if not $hideUptime }}
                          {{ $uptimeSec := $info.Float "u" }}
                          {{ if ge $uptimeSec 86400.0 }}
                            <p style="font-size: 1em;">Uptime: {{ printf "%.2f" (mul $uptimeSec 0.000011574) }}d</p>
                          {{ else }}
                            <p style="font-size: 1em;">Uptime: {{ printf "%.2f" (mul $uptimeSec 0.000277778) }}h</p>
                          {{ end }}
                        {{ end }}
                        {{ if not $hideCPUInfo }}
                          <p style="font-size: 1em;">CPU: {{ replaceAll "CPU " "" ($info.String "m") }}</p>
                        {{ end }}
                        <p style="font-size: 1em; margin-top: 0.5em;">üìä Cpu: {{ $info.Float "cpu" }}%</p>
                        <p style="font-size: 1em;">üß† Memory: {{ $info.Float "mp" }}%</p>
                        <p style="font-size: 1em;">üíæ Disk: {{ $info.Float "dp" }}%</p>
                      </div>
                    </details>
                  {{ else }}
                    <div class="margin-top-5">
                      {{ if not $hideKernel }}
                        <p style="font-size: 1em;">Kernel: {{ $info.String "k" }}</p>
                      {{ end }}
                      {{ if not $hideUptime }}
                        {{ $uptimeSec := $info.Float "u" }}
                        {{ if ge $uptimeSec 86400.0 }}
                          <p style="font-size: 1em;">Uptime: {{ printf "%.2f" (mul $uptimeSec 0.000011574) }}d</p>
                        {{ else }}
                          <p style="font-size: 1em;">Uptime: {{ printf "%.2f" (mul $uptimeSec 0.000277778) }}h</p>
                        {{ end }}
                      {{ end }}
                      {{ if not $hideCPUInfo }}
                        <p style="font-size: 1em;">CPU: {{ replaceAll "CPU " "" ($info.String "m") }}</p>
                      {{ end }}
                      <p style="font-size: 1em; margin-top: 0.5em;">üìä Cpu: {{ $info.Float "cpu" }}%</p>
                      <p style="font-size: 1em;">üß† Memory: {{ $info.Float "mp" }}%</p>
                      <p style="font-size: 1em;">üíæ Disk: {{ $info.Float "dp" }}%</p>
                    </div>
                  {{ end }}
                {{ end }}
